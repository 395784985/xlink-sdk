# 邮件模板管理 #

邮件模板管理为企业提供各种定制化邮件内容，按要求发送给企业用户等系列功能。目前提供如下模板功能：
+ 用户注册激活邮件模板
+ 用户找回密码邮件模板

## 1. 邮件模板提供的接口 ##

### 1.1 新增邮件模板接口 ###

新增邮件模板需要向服务器发起一个POST请求。

#### Request ####

请求的url、header以及必须填充的content如下：

URL

	POST /v2/email/template 

HEADER

	Content-Type:"application/json"
	Access-Token:"调用凭证"

Content

	{
		"name":"模板名称",
		"subject":"邮件标题",
		"sender":"发送者",
		"content":"邮件正文",
		"type":"邮件模板类型",
		"lang":"语言类型"
	}

字段		|是否必须| 描述
--------|-------|-----
name	| 是		| 邮件模板名称，30个字符以内
sender	| 是		| 邮件发送方
content	| 是		| 邮件正文，在不同邮件模板类型下，正文会有不同的参数必填项，详情下方附有说明
type	| 是		| 邮件模板类型，见附录
lang	| 是		| 语言类型，见附录

#### Response ####

新增模板得到服务器响应如下：

Header

	HTTP/1.1 200 OK

Content

	{
	    "id":"邮件模板ID",
	    "name":"模板名称",
	    "subject":"邮件标题",
	    "sender":"发送者",
	    "content":"邮件正文",
	    "type":"邮件模板类型",
	    "lang":"语言类型",
	    "status":"邮件模板审核状态",
	    "update_time":"更新时间"
	}

 字段	|是否必须| 描述
--------|-------|----
id			|是	| 邮件模板ID
name		|是	| 邮件模板名称，30个字符以内
sender		|是	| 邮件发送方
content		|是	| 邮件正文，在不同邮件模板类型下，正文会有不同的变量必填项，详情见附录
type		|是	| 邮件模板类型，见附录
lang		|是	| 语言类型，见附录
status		|是	| 邮件模板审核状态，见附录
update_time	|是	| 更新时间，例：2014-10-09T08:15:40.843Z


### 1.2 修改邮件模板接口 ###

修改邮件模板需要向服务器发起PUT请求。

#### Request ####

请求的url、header以及content如下，其中url的{template_id}为新增邮件模板返回的ID值。

URL

	PUT /v2/email/template/{template_id}

Header

	Content-Type:"application/json"
	Access-Token:"调用凭证"

Content

	{
	    "name":"模板名称",
	    "subject":"邮件标题",
	    "sender":"发送者",
	    "content":"邮件正文"
	}

#### Response ####

修改邮件模板得到服务器响应如下：

Header

	HTTP/1.1 200 OK

Content

	{
	    "id":"邮件模板ID",
	    "name":"模板名称",
	    "subject":"邮件标题",
	    "sender":"发送者",
	    "content":"邮件正文",
	    "type":"邮件模板类型",
	    "lang":"语言类型",
	    "status":"邮件模板审核状态",
	    "update_time":"更新时间"
	}

### 1.3 获取邮件模板列表接口 ###

获取邮件模板列表需要向服务器发起GET请求。

#### Request ####

请求的url、header以及content如下：

URL

	GET /v2/email/template_list

Header

	Content-Type:"application/json"
	Access-Token:"调用凭证"

Content

	无

#### Response ####

获取邮件模板列表得到服务器响应如下：

Header

	HTTP/1.1 200 OK

Content

	{
	    "count":"返回数量",
	    "list":
	    {
	        "id":"邮件模板ID",
	        "name":"模板名称",
	        "subject":"邮件标题",
	        "sender":"发送者",
	        "content":"邮件正文",
	        "type":"邮件模板类型",
	        "lang":"语言类型",
	        "status":"邮件模板审核状态",
	        "update_time":"更新时间"
	    }
	}


## 2. 邮件模板正文变量说明 ##

设置邮件模板正文需要注意要被替换的变量名规则。

### 2.1 用户注册激活邮件模板实例 ###

如下为用户向云智易注册后发送的激活帐号邮件模板。

发件人：

	xlink@mail.xlink.cn

标题：

	云智易注册通知

正文：

	亲爱的 %username%，
	
	欢迎注册云智易，请点击下方的链接完成帐号激活。
	
	 http://admin.xlink.cn/#!/user-email-activate/%corp_id%/%email%/%verifycode%
	
	 （本链接将在48小时后失效）
	
	本邮件由系统自动发出，请勿回复
	
	---------
	
	云智易
	
	%date%

以下为模板内容变量必填项：

 字段		| 描述
----		|----
%username%	| 用户昵称，Base64编码
%corp_id%	| 企业ID，Base64编码
%email%		| 邮箱地址，Base64编码
%verifycode%| 验证码，Base64编码
%date%		| 日期，例：2016-01-13 15:30


### 2.2 用户找回密码邮件模板 ###

如下为用户忘记密码，申请邮件找回密码的邮件模板。

发件人：

	xlink@mail.xlink.cn

标题：

	云智易找回密码

正文：

	亲爱的   %username%，
	
	我们收到了您找回密码的请求，请点击下方链接完成密码找回：
	
	http://admin.xlink.cn/#!/user-password-reset/%corp_id%/%email%/%verifycode%
	
	（本链接将在48小时后失效）
	
	本邮件由系统自动发出，请勿回复
	
	---------
	
	云智易
	
	%date%

以下为模板内容变量必填项：

 字段		| 描述
----		|----
%username%	| 用户昵称，Base64编码
%corp_id%	| 企业ID，Base64编码
%email%		| 邮箱地址，Base64编码
%verifycode%| 验证码，Base64编码
%date%		| 日期，例：2016-01-13 15:30

## 附录 ##

### 1. 邮件模板类型 ###
+ 1：用户注册激活邮件
+ 2：用户找回密码邮件

### 2. 邮件模板审核状态 ###
+ -2：未提交审核
+ -1：审核不通过
+ 0：待审核
+ 1：审核通过

### 3. 语言类型 ###
+ zh-cn ：中文（简体）
+ en-us ：英语（美国）